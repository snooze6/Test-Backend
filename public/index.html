<!DOCTYPE html>
<html ng-app="TestApp">
    <head>
        <meta charset="UTF-8">
        <title>Title</title>

        <!-- css -->
        <link rel="stylesheet" href="vendor/fonts/iconfont/material-icons.css">
        <link rel="stylesheet" href="vendor/stylesheets/materialize.min.css">

        <!-- vendors -->
        <script src="vendor/javascripts/jquery-2.2.3.min.js"></script>
        <script src="vendor/javascripts/materialize.min.js"></script>
        <script src="vendor/javascripts/angular.min.js"></script>
        <script src="vendor/javascripts/angular-route.min.js"></script>

        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    </head>

    <script>
        $( document ).ready(function(){
            $(".button-collapse").sideNav();
        });

        var TestApp = angular.module('TestApp', ['ngRoute']);

        TestApp.config(function($routeProvider) {
            $routeProvider.
                when('/', {
                    templateUrl: 'views/testlist.html',
                    controller: 'Ctrl_TestList'
                }).
                when('/:testId', {
                    templateUrl: 'views/testdetail.html',
                    controller: 'Ctrl_TestDetail'
                }).
                otherwise({
                    redirectTo: '/'
                });
        });

        TestApp.factory('tests', function($http){
            return {
                list: function (callback){
                    $http({
                        method: 'GET',
                        url: 'api/v1/tests',
                        cache: true
                    }).success(callback);
                },
                find: function(id, callback){
                    $http({
                        method: 'GET',
                        url: 'api/v1/tests/'+id,
                        cache: true
                    }).success(callback);
                }
            };
        });

        TestApp.controller('Ctrl_TestList', function ($scope, tests){
            tests.list(function(tests) {
                console.log('Listing');
                $scope.tests = tests.docs;
            });
        });

        TestApp.controller('Ctrl_TestDetail', function ($scope, $routeParams, tests){
            tests.find($routeParams.testId, function(test) {
                console.log('Getting');
                console.log(test);
                $scope.test = test;
            });
        });

    </script>

    <body>
        <nav>
            <div class="nav-wrapper">
                <a href="#!" class="brand-logo">Logo</a>
                <a href="#" data-activates="mobile-demo" class="button-collapse">
                    <i class="material-icons">menu</i>
                </a>
                <ul class="right hide-on-med-and-down">
                    <li><a href="sass.html">Sass</a></li>
                    <li><a href="badges.html">Components</a></li>
                    <li><a href="collapsible.html">Javascript</a></li>
                    <li><a href="mobile.html">Mobile</a></li>
                </ul>
                <ul class="side-nav" id="mobile-demo">
                    <li><a href="sass.html">Sass</a></li>
                    <li><a href="badges.html">Components</a></li>
                    <li><a href="collapsible.html">Javascript</a></li>
                    <li><a href="mobile.html">Mobile</a></li>
                </ul>
            </div>
        </nav>

        <h1>Hello</h1>

        <!--Content-->
        <div ng-view></div>

    </body>
</html>